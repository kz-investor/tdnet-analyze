## ユーザエクスペリエンスの定義（実装完了済み）

### 基本フロー ✅
* 日付を指定して、その日の決算短信の証券コードをリストする。
* そのリストに対して、33業種区分＋規模区分でフラグ付けする（`inputs/companies.csv`活用）
* 各証券コードに対して、ループ処理する。
  * 決算短信、プレゼンテーション資料、その他重要文書があれば取得する
  * **全文書を証券コード単位で統合**し、LLMで要約・重要ポイントを抽出する
  * **規模区分に応じて詳細版/コンパクト版プロンプトを自動選択**
  * 並列処理として行う（最大25並列）
  * 個別サマリーを`insights-summaries/YYYYMMDD/`に`yyyymmdd_セクター名_規模区分_証券コード_summary.md`として保存

### セクター分析フロー ✅
* **33業種×規模区分**でグループ化（例：サービス業_Small_2）
* 各グループの個別サマリーを統合し、**4ステップ構造化分析フレームワーク**でセクターインサイト生成：
  1. 個別企業サマリーの横断分析
  2. セクター共通項の深掘り分析  
  3. 企業間競争力分析（勝ち組の条件特定）
  4. 投資戦略とアクションプランの構築
* セクターインサイトを`insights-sectors/YYYYMMDD/`に`セクター名_規模区分_insights.md`として保存

### 技術実装詳細 ✅
- **モデル**: Vertex AI Gemini 2.5 Flash Lite（us-central1）
- **プロンプト管理**: `prompt_templates/`でシステム・ユーザープロンプト分離
- **規模区分判定**: Core30/Large70/Mid400 = 大型株（詳細分析）、その他 = 小型株（コンパクト分析）
- **エラーハンドリング**: リージョン設定、依存関係管理、Cloud Scheduler構文修正済み